<!-- Gallery shortcode for enhanced image display -->
{{ $gallery := .Get "images" | split "," }}
{{ $layout := .Get "layout" | default "grid" }}
{{ $columns := .Get "columns" | default "3" }}
{{ $captions := .Get "captions" | split "," }}

<div class="gallery layout-{{ $layout }}" data-columns="{{ $columns }}">
  {{ range $index, $image := $gallery }}
    {{ $caption := index $captions $index }}
    <div class="gallery-item animate-fade hover-lift">
      <img src="{{ $image | relURL }}" 
           alt="{{ $caption | default (printf "Gallery image %d" (add $index 1)) }}" 
           loading="lazy"
           class="gallery-image">
      {{ if $caption }}
        <div class="gallery-caption">{{ $caption }}</div>
      {{ end }}
    </div>
  {{ end }}
</div>

<style>
.gallery {
  margin: 2rem 0;
  gap: 1rem;
}

.gallery.layout-grid {
  display: grid;
  grid-template-columns: repeat(var(--gallery-columns, {{ $columns }}), 1fr);
}

.gallery.layout-carousel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  padding: 1rem 0;
}

.gallery.layout-masonry {
  column-count: var(--gallery-columns, {{ $columns }});
  column-gap: 1rem;
}

.gallery-item {
  position: relative;
  border-radius: 8px;
  overflow: hidden;
  background: #f8f9fa;
  transition: all 0.3s ease;
}

.gallery.layout-carousel .gallery-item {
  flex: 0 0 300px;
  scroll-snap-align: start;
}

.gallery.layout-masonry .gallery-item {
  break-inside: avoid;
  margin-bottom: 1rem;
}

.gallery-image {
  width: 100%;
  height: auto;
  display: block;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.gallery-item:hover .gallery-image {
  transform: scale(1.05);
}

.gallery-caption {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
  color: white;
  padding: 1rem;
  font-size: 0.875rem;
  transform: translateY(100%);
  transition: transform 0.3s ease;
}

.gallery-item:hover .gallery-caption {
  transform: translateY(0);
}

@media (max-width: 768px) {
  .gallery.layout-grid[data-columns="4"],
  .gallery.layout-grid[data-columns="3"] {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .gallery.layout-masonry {
    column-count: 2;
  }
  
  .gallery.layout-carousel .gallery-item {
    flex: 0 0 250px;
  }
}

@media (max-width: 480px) {
  .gallery.layout-grid {
    grid-template-columns: 1fr;
  }
  
  .gallery.layout-masonry {
    column-count: 1;
  }
  
  .gallery.layout-carousel .gallery-item {
    flex: 0 0 200px;
  }
}
</style>